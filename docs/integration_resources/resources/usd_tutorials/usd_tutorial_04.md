## Converting Between Layer Formats

This tutorial is focused on converting layer files between the different native USD file formats using the operators from the Shift_USD catalog.

The base file for the example, `Sphere.usd`, can be downloaded from the [OpenUSD](https://github.com/PixarAnimationStudios/OpenUSD) Github project repository, from `extras/usd/tutorials/convertingLayerFormats/` folder.


### Converting between .usda/.usdc and .usd

1. Open Shift application. A new window's instance of Shift should appear like the following one:

<figure>
    <img src="images/usd_tutorial_04/step_01_t04.png" alt="Shift UI.">
    <figcaption><b>Figure 1</b>: Shift UI.</figcaption>
</figure>

2. First, add a new **<tt>UsdStageOpen</tt>** node to the board and rename it as `OpenUsdFile`. Using the **Inspector** widget, set as the value for the **filepath** input plug a filepath pointing to a `.usd` file. For the current example, the filepath can be: `D:/USD_TUTORIALS/04/Sphere.usd`. The board should look like the following:

<figure>
    <img src="images/usd_tutorial_04/step_02_t04.png" alt="Added 'OpenUsdFile' node to the board.">
    <figcaption><b>Figure 2</b>: Added 'OpenUsdFile' node to the board.</figcaption>
</figure>

3. To save a `.usda` file, add a new **<tt>UsdStageSave</tt>** node to the board and rename it as `SaveAsUsdaFile`. Connect the **stage** output plug from the `OpenUsdFile` node to the **stage** input plug of the new node. Set as the value for the **filepath** input plug a valid filepath to a `.usda` file, for example, `D:/USD_TUTORIALS/04/Sphere.usda`. The board should look like the following:

<figure>
    <img src="images/usd_tutorial_04/step_03_t04.png" alt="Added 'SaveAsUsdaFile' node to the board connected to 'OpenUsdFile' node.">
    <figcaption><b>Figure 3</b>: Added 'SaveAsUsdaFile' node to the board connected to 'OpenUsdFile' node.</figcaption>
</figure>

4. Execute the workflow. Doing this, a new file with the `.usda` extension will be generated using as information the `.usd` file. The board should look like the following:

<figure>
    <img src="images/usd_tutorial_04/step_04_t04.png" alt="Executed the workflow for creating the '.usda' file.">
    <figcaption><b>Figure 4</b>: Executed the workflow for creating the '.usda' file.</figcaption>
</figure>

5. Now, add another new **<tt>UsdStageOpen</tt>** node to the board and rename it as `OpenUsdaFile`. Set the value for the **filepath** input plug of the current node to point to the file generated by the `SaveAsUsdaFile` node, meaning having in the current example the value: `D:/USD_TUTORIALS/04/Sphere.usda`. The board should look like the following:

<figure>
    <img src="images/usd_tutorial_04/step_05_t04.png" alt="Added 'OpenUsdaFile' node to the board.">
    <figcaption><b>Figure 5</b>: Added 'OpenUsdaFile' node to the board.</figcaption>
</figure>

6. To save a `.usdc` file, add a new **<tt>UsdStageSave</tt>** node to the board and rename it as `SaveAsUsdcFile`. Connect the **stage** output plug from the `OpenUsdaFile` node to the **stage** input plug of the new node. Set as the value for the **filepath** input plug a valid filepath to a `.usdc` file, for example, `D:/USD_TUTORIALS/04/Sphere.usdc`. The board should look like the following:

<figure>
    <img src="images/usd_tutorial_04/step_06_t04.png" alt="Added 'SaveAsUsdcFile' node to the board connected to 'OpenUsdaFile' node.">
    <figcaption><b>Figure 6</b>: Added 'SaveAsUsdcFile' node to the board connected to 'OpenUsdaFile' node.</figcaption>
</figure>

7. As previously done, execute the workflow again. Doing this, a new file with the `.usdc` extension will be generated using as information the `.usda` file. The board should look like the following:

<figure>
    <img src="images/usd_tutorial_04/step_07_t04.png" alt="Executed the workflow for creating the '.usdc' file.">
    <figcaption><b>Figure 7</b>: Executed the workflow for creating the '.usdc' file.</figcaption>
</figure>


### Run verifications

1. For running the verification between the original `Sphere.usd` file and the generated file `Sphere.usda`, use the terminal for executing the <tt>usddiff</tt> tool shipped with USD for showing the difference between 2 USD files. The terminal should show no differences:

<figure>
    <img src="images/usd_tutorial_04/verification_01_t04.png" alt="Usddiff command executed between original 'Sphere.usd' file and generated 'Sphere.usda' file." width="475" height="133">
    <figcaption><b>Figure 8</b>: Usddiff command executed between original 'Sphere.usd' file and generated 'Sphere.usda' file.</figcaption>
</figure>

2. As previously done, for running the verification between the `Sphere.usda` file and the `Sphere.usdc` file, use the terminal for executing the <tt>usddiff</tt> tool. The terminal should show no differences:

<figure>
    <img src="images/usd_tutorial_04/verification_02_t04.png" alt="Usddiff command executed between 'Sphere.usda' and 'Sphere.usdc' files."  width="475" height="133">
    <figcaption><b>Figure 9</b>: Usddiff command executed between 'Sphere.usda' and 'Sphere.usdc' files.</figcaption>
</figure>


### Workflow Resources

In the Shift installation folder you can find the provided example workflow for the explained tutorial. Is the file named `tutorial_04.sft` located in: `<path_to_the_shift_installation_folder>/shift/examples/USD/tutorials/tutorial_04_converting_layer_formats/`.
